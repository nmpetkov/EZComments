<!--[*  $Id$  *]-->
<!--[pnpageaddvar name="javascript" value="modules/EZComments/pnjavascript/toggle.js"]-->
<!--[pnsecauthaction comp='EZComments::' inst='::' level=ACCESS_MODERATE assign='perm_mod']-->
<!--[gt text="The last %s comment" plural="The last %s comments" count=$itemsperpage tag1=$itemsperpage assign=templatetitle]-->
<!--[include file="ezcomments_user_header.htm"]-->

<h3><!--[$templatetitle]--></h3>
<form class="z-form" action="<!--[pnmodurl modname=EZComments]-->" method="post">
    <fieldset>
        <label for="ezcomments_filter"><!--[gt text="Filter by status"]--></label>
        <select id="ezcomments_filter" name="status">
            <option value="-1"<!--[if $status eq -1]--> selected="selected"<!--[/if]-->><!--[gt text="All"]--></option>
            <option value="0"<!--[if $status eq 0]--> selected="selected"<!--[/if]-->><!--[gt text="Approved"]--></option>
            <option value="1"<!--[if $status eq 1]--> selected="selected"<!--[/if]-->><!--[gt text="Pending"]--></option>
            <option value="2"<!--[if $status eq 2]--> selected="selected"<!--[/if]-->><!--[gt text="Rejected"]--></option>
        </select>
        <input type="submit" value="<!--[gt text="Filter"]-->" />
    </fieldset>
</form>

<form class="z-form" id="ezcomments_view" action="<!--[pnmodurl modname=EZComments func=processselected]-->" method="post">
    <div>
        <input type="hidden" name="authid" value="<!--[insert name='generateauthkey' module='EZComments']-->" />
        <table id="ezcomments_comments" class="z-datatable">
            <thead>
                <tr>
                    <!--[if $perm_mod]-->
                    <th><input type="checkbox" onclick="checkAllFields(1);" id="checkAll" /></th>
                    <!--[/if]-->
                    <th><!--[gt text="Status"]--></th>
                    <th><!--[gt text="User"]--></th>
                    <th><!--[gt text="Content owner"]--></th>
                    <th><!--[gt text="Module"]--></th>
                    <th><!--[gt text="Comment"]--></th>
                    <th><!--[gt text="Options"]--></th>
                </tr>
            </thead>
            <tbody>
                <!--[foreach from=$items item=item]-->
                <tr class="<!--[cycle values=z-odd,z-even]-->">
                    <!--[if $perm_mod]-->
                    <td>
                        <input type="checkbox" name="comments[]" value="<!--[$item.id]-->" onclick="checkAllFields(2);" />
                    </td>
                    <!--[/if]-->
                    <td>
                        <!--[if $item.status eq 0]--><!--[pnimg modname="EZComments" src='green.gif' __alt='Approved' __title='Approved']--><!--[/if]-->
                        <!--[if $item.status eq 1]--><!--[pnimg modname="EZComments" src='yellow.gif' __alt='Pending' __title='Pending']--><!--[/if]-->
                        <!--[if $item.status eq 2]--><!--[pnimg modname="EZComments" src='red.gif' __alt='Rejected' __title='Rejected']--><!--[/if]-->
                    </td>
                    <td>
                        <!--[if $item.uid neq 0]-->
                        <!--[$item.uid|userprofilelink]-->
                        <!--[else]-->
                        <!--[$item.anonname|pnvarprepfordisplay]-->
                        <!--[/if]-->
                        <br /><!--[$item.date|pndate_format]-->
                    </td>
                    <td>
                        <!--[if $item.owneruid ne "0"]-->
                        <!--[$item.owneruid|userprofilelink]-->
                        <!--[else]-->
                        <!--[gt text="unknown"]-->
                        <!--[/if]-->
                    </td>
                    <td><a href="<!--[$item.url|pnvarprepfordisplay]-->"><!--[$item.mod|pnvarprepfordisplay]--></a></td>
                    <td><!--[$item.comment|strip_tags|truncate:80]--></td>
                    <td>
                        <!--[assign var="options" value=$item.options]-->
                        <!--[section name=options loop=$options]-->
                        <a href="<!--[$options[options].url|pnvarprepfordisplay]-->"><!--[pnimg modname='core' set='icons/extrasmall' src=$options[options].image title=$options[options].title alt=$options[options].title]--></a>
                        <!--[/section]-->
                    </td>
                </tr>
                <!--[foreachelse]-->
                <tr class="z-datatableempty">
                    <!--[if $perm_mod]-->
                    <td colspan="7"><!--[gt text="No items found"]--></td>
                    <!--[else]-->
                    <td colspan="6"><!--[gt text="No items found"]--></td>
                    <!--[/if]-->
                </tr>
                <!--[/foreach]-->
            </tbody>
        </table>

        <!--[if $perm_mod]-->
        <fieldset>
            <label for="ezcomments_action"><!--[gt text="With selected comments"]--></label>
            <select id="ezcomments_action" name="action">
                <option value=""><!--[gt text="Choose action"]--></option>
                <option value="delete"><!--[gt text="Delete"]--></option>
                <option value="approve"><!--[gt text="Approve"]--></option>
                <option value="hold"><!--[gt text="Hold"]--></option>
                <option value="reject"><!--[gt text="Reject"]--></option>
            </select>
            <input type="submit" value="<!--[gt text="Submit"]-->" />
        </fieldset>
        <!--[/if]-->
    </div>
</form>

<!--[pager show="page" rowcount=$ezc_pager.numitems limit=$ezc_pager.itemsperpage posvar=startnum shift=1]-->
