<!--[*  $Id$ *]-->

<a id="comments"></a>

<!--[if $comments eq true]-->
<!--[* Here we show the given comments *]-->

<h3><!--[gt text="Comments" domain="module_ezcomments"]--></h3>
<!--[if $allowadd]-->
<a href="#commentform"><!--[gt text="Add a new comment" domain="module_ezcomments"]--></a>
<!--[/if]-->
<!--[pnmodavailable modname="InterCom" assign="intercom"]-->

<!--[foreach from=$comments item="comment"]-->
<div class="ezc_box">
    <div class="ezc_info">
        <div class="ezc_avatar">
            <!--[if $comment._YOURAVATAR ne "" and $comment._YOURAVATAR ne "blank.gif"]-->
            <img src="<!--[pngetbaseurl]-->/images/avatar/<!--[$comment._YOURAVATAR]-->" />
            <!--[else]-->
            <img src="<!--[pngetbaseurl]-->images/icons/large/personal.gif" />
            <!--[/if]-->
        </div>
        <div class="ezc_userinfo">
            <!--[gt text="Author" domain="module_ezcomments"]-->:
            <!--[if $comment.anonname ne '']-->
            <!--[if $comment.anonwebsite != '']-->
            <a href="<!--[$comment.anonwebsite]-->">
                <!--[/if]-->
                <!--[$comment.anonname]-->
                <!--[if $comment.anonwebsite ne '']-->
            </a>
            <!--[/if]-->
            <!--[else]-->
            <!--[$comment.pn_uname|userprofilelink]-->
            <!--[/if]-->
            <br />
            <!--[$comment.date|pndate_format]-->
        </div>
        <div class="ezc_icons">
            <!--[if $intercom]-->
            <!--[if $comment.anonmail ne '']-->
            <a href="mailto:<!--[$comment.anonmail]-->"><img src="<!--[pngetbaseurl]-->images/icons/extrasmall/mail_generic.gif" alt="<!--[gt text="Send mail to user" domain="module_ezcomments"]-->" title="<!--[gt text="Send mail to user" domain="module_ezcomments"]-->" /></a>
            <!--[else]-->
            <a href="<!--[pnmodurl modname="InterCom" func="newpm" uid=$comment.uid]-->"><img src="<!--[pngetbaseurl]-->images/icons/extrasmall/mail_generic.gif" alt="<!--[gt text="Send mail to user" domain="module_ezcomments"]-->" title="<!--[gt text="Send mail to user" domain="module_ezcomments"]-->" /></a>
            <!--[/if]-->

            <!--[if $comment.del]-->
            <a href="<!--[pnmodurl fqurl="true" modname=EZComments type=user func=modify id=$comment.id redirect=$redirect]-->"><img src="<!--[pngetbaseurl]-->images/icons/extrasmall/14_layer_deletelayer.gif"></a>
            <!--[/if]-->

            <!--[/if]-->
        </div>
    </div>
    <div class="ezc_comment">
        <span class="ezc_title"><!--[$comment.subject|pnvarprepfordisplay]--></span>
        <div class="ezc_commentscroll">
            <!--[$comment.comment|pnvarprepfordisplay|nl2br|pnmodcallhooks]-->
        </div>
    </div>
    <div class="ezc_line">
        <hr />
    </div>
</div>
<!--[foreachelse]-->
<p class="z-informationmsg"><!--[gt text="No comments posted yet" domain="module_ezcomments"]--></p>
<!--[/foreach]-->

<!--[if $enablepager]-->
<div class="z-center">
    <!--[pager show="page" rowcount=$pager.numitems limit=$pager.itemsperpage posvar=comments_startnum shift=1]-->
</div>
<!--[/if]-->

<!--[/if]-->

<!--[if $allowadd]-->
<a id="commentform"></a>
<!--[* This is the form to comment. It is shown only, when the user is allowed to. *]-->
<form class="z-form z-linear" id="post" action="<!--[pnmodurl modname=EZComments func=create]-->" method="post">
    <div>
        <input type="hidden" name="authid" id="authid" value="<!--[pnsecgenauthkey module=EZComments]-->" />
        <input type="hidden" name="redirect" id="EZComments_redirect" value="<!--[$redirect|pnvarprepfordisplay]-->" />
        <input type="hidden" name="mod" id="EZComments_modname" value="<!--[pnmodgetname]-->" />
        <input type="hidden" name="owneruid" id="EZComments_owneruid" value="<!--[$owneruid|pnvarprepfordisplay]-->" />
        <input type="hidden" name="useurl" id="EZComments_useurl" value="<!--[$useurl|pnvarprepfordisplay]-->" />
        <input type="hidden" name="objectid" id="EZComments_objectid" value="<!--[$objectid|pnvarprepfordisplay]-->" />
        <fieldset>
            <legend><!--[gt text="Add a new Comment" domain="module_ezcomments"]--></legend>
            <div class="z-formrow">
                <label for="subject"><!--[gt text="Subject" domain="module_ezcomments"]--></label>
                <input type="text" name="subject" id="subject" size="50" maxlength="255" />
            </div>
            <!--[if $loggedin neq true and $anonusersinfo eq true]-->
            <div class="z-formrow">
                <label for="anonname"><!--[gt text="Name" domain="module_ezcomments"]--><!--[if $anonusersrequirename eq true]--> <span><!--[gt text="(required for unregistered users)" domain="module_ezcomments"]--></span><!--[/if]--></label>
                <input type="text" name="anonname" id="anonname" size="50" maxlength="255" />
            </div>
            <div class="z-formrow">
                <label for="anonmail"><!--[gt text="E-mail address (will not be published)" domain="module_ezcomments"]--></label>
                <input type="text" name="anonmail" id="anonmail" size="50" maxlength="255" />
            </div>
            <!--[/if]-->
            <div class="z-formrow">
                <label for="message"><!--[gt text="Comment" domain="module_ezcomments"]--></label>
                <textarea name="comment" id="message" cols="60" rows="10"></textarea>
            </div>
        </fieldset>
        <div class="z-formbuttons">
            <!--[pnbutton src='button_ok.gif' set='icons/small' __alt='Submit comment' __title='Submit comment']-->
        </div>
    </div>
</form>
<!--[else]-->
<div>
    <p class="z-warningmsg">
        <!--[gt text="Only logged in users are allowed to comment." domain="module_ezcomments"]-->
        <a href="<!--[pnmodurl modname="Users" func="register"]-->"><!--[gt text="Register/log in." domain="module_ezcomments"]--></a>
    </p>
</div>
<!--[/if]-->

